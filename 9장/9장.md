# Chapter 9 모듈
모듈과 모듈 시스템

## 모듈성
### 모듈이란?
- 프로그램을 구성하는 시스템을 기능 단위로 독립적이게 분리한 것?
- 모듈성을 갖는.
- 독립성 + 은닉성 = 모듈성

### 모듈 시스템?
- 연관된 코드 묶음이 모듈성을 갖도록 하는 시스템
- 의존성 관리: 어떤 의존성이 필요한지 명시해야
- 캡슐화 관리: 불필요한 구현을 외부로 드러내지 않아야

```
@Module({
	controllers: [CatsController],
	providers: [CatsService],
	imports: [CommonModule],
	exports: [CatsService],
})
export class CatsModule {}
```
- CatsController, CatsService 클래스가 컴포넌트로 선언
- CommonModule은 해당 모듈이 의존하고 있는 외부 모듈(의존성 관리)
- CatsService는 이 모듈에서 외부로 노출할 컴포넌트(캡슐화 관리)
- 이런 식의 코드 묶음을 모듈이라고 함.

## 모듈 디스크립터(module descriptor)
자바 9부터 지원, 자바의 확실한 모듈 시스템.
```
module myproject.main {
	requires org.apache.httpcomponents.httpclient;
	exports com.myorg.myproject.model;
}
```
> requires로 의존성 관리, exports로 캡슐화 관리
- 원래도 모듈 개념은 있었지만, 모듈 디스크럽터로 확실한 모듈 시스템이 생긴 것.

## 독립성?
1. 최대한 내부에서 해결하라
2. 외부에는 강하게 의존하지 마라
3. 외부 시스템을 사용한다면 **외부 시스템의 사용을 명시하라**
> 모듈이 독립성을 보장하려면 모듈의 의존성을 명시하여 드러내고 관리해야 한다.

## 은닉성?
모듈을 외부에 공유하더라도 공개된 인터페이스 이외에 불필요한 정보를 숨겨야.
### why?
작업하기 편하기 때문.
- ex) 어떤 라이브러리 가져오면 해당 라이브러리에 있는 모든 클래스 사용할 수 있게 됨.
-	임시 클래스인 Temp를 개발자의 의도와 다르게 사용자가 사용하고 있었는데, 이를 수정하면 에러.
-	이처럼 API를 사용하는 사용자가 충분히 많다면 개발자의 설계 의도는 더 이상 중요하지 않게 된다.
-	따라서 불필요한 Temp 클래스와 같은 정보는 숨겨야 개발자가 작업하기 편해진다.

## MSA(Microservice Architecture)
어떤 시스템을 만들 때 하나의 거대한 서버를 만드는 것이 아니라, 더 작은 단위의 독립된 애플리케이션을 여러 개 만들어 하나의 시스템이 동작하게 만드는 것.
- MSA 환경에서는 마이크로서비스들을 모듈로 볼 수 있음.
-	독립성: 마이크로서비스는 거대한 시스템의 독립된 일부 도메인
-	은닉성
- MSA는 거대한 시스템을 세분화된 모듈 단위 시스템으로 만들고자 하는 시도!

## 패키지 구조
### 계층 기반 구조(레이어드 아키텍처)
- ex page279.
-	UserController, CafeController 등 컨트롤러는 Controller끼리, Repository는 레포끼리.
- 	계층을 두고 해당 계층에 대응하는 컴포넌트를 아래에 넣는 방식.
- 이해하기 쉬움. but 도메인이 눈에 안 들어와.
> 응집도가 떨어지고 비즈니스 코드를 한곳에 모아볼 수 없게 됨. pg281처럼 연관 클래스가 각기 다른 패키지에 분산되어 관리됨.

### 도메인 기반 구조
- UserController, UserService, UserRepository 등을 user로 묶음. 
- 도메인별로 패키지를 나눠 연관된 도메인 코드를 배치
- 도메인 코드를 한 곳으로 모았지만, 계층은 눈에 안 들어옴.

### 도메인 -> 계층 기반 구조?
pg284

### 어떻게 선택?
- 작은 규모의 프로젝트라면 단순하고 직관적은 계층 기반 구조
- 큰 규모의 프로젝트라면 비즈니스 도메인의 복잡성을 관리하기 위해 도메인 기반 구조

**때에 따라 다르다.**

- 현재 진행 중인 프로젝트의 주요 단위가 무엇인지 생각해보고 패키지 구조를 선택하자
-	계층 기반 구조라면 계층을 모듈로
-	도메인 기반 구조라면 도메인을 모듈로
